"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SegmentEncoder=void 0;var Base64Url_js_1=require("./Base64Url.js"),BitLength_js_1=require("./BitLength.js"),index_js_1=require("./field/index.js"),index_js_2=require("./sequence/index.js"),index_js_3=require("../errors/index.js"),Fields_js_1=require("../model/Fields.js"),index_js_4=require("../model/index.js"),SegmentEncoder=function(){function e(){}return e.decode=function(e,i,s){var n=this,r=Base64Url_js_1.Base64Url.decode(e),t=0;s===index_js_4.Segment.CORE&&(i.version=index_js_1.IntEncoder.decode(r.substr(t,BitLength_js_1.BitLength[Fields_js_1.Fields.version]),BitLength_js_1.BitLength[Fields_js_1.Fields.version])),s!==index_js_4.Segment.CORE&&(t+=BitLength_js_1.BitLength.segmentType);var d=this.fieldSequence[String(i.version)][s],_=(0,index_js_1.FieldEncoderMap)();return d.forEach((function(e){var s=_[e],d=BitLength_js_1.BitLength[e];if(void 0===d&&n.isPublisherCustom(e)&&(d=Number(i[Fields_js_1.Fields.numCustomPurposes])),0!==d){var o=r.substr(t,d);if(s===index_js_1.VendorVectorEncoder?i[e]=s.decode(o,i.version):i[e]=s.decode(o,d),Number.isInteger(d))t+=d;else{if(!Number.isInteger(i[e].bitLength))throw new index_js_3.DecodingError(e);t+=i[e].bitLength}}})),i},e.isPublisherCustom=function(e){return 0===e.indexOf("publisherCustom")},e.fieldSequence=new index_js_2.FieldSequence,e}();exports.SegmentEncoder=SegmentEncoder;